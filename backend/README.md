# Earthframe Backend

This project uses [Poetry](https://python-poetry.org/) for dependency management and [FastAPI](https://fastapi.tiangolo.com/) as the web framework.

## Setup Instructions

### 1. Install Poetry

If you don't have Poetry installed, run:

```bash
curl -sSL https://install.python-poetry.org | python3 -
```

Or follow the [official instructions](https://python-poetry.org/docs/#installation).

### 2. Install Dependencies

Navigate to the project directory and install dependencies:

```bash
cd /Users/vo13/repositories/earthframe/backend
poetry install
```

### 3. Activate the Poetry Shell (optional)

```bash
poetry shell
```

### 4. Run FastAPI Application

You can start the FastAPI server using [uvicorn](https://www.uvicorn.org/):

```bash
poetry run uvicorn app.main:app --reload
```

- Replace `main:app` with the actual module and app name if different.

The API will be available at [http://127.0.0.1:8000](http://127.0.0.1:8000).

### 5. API Documentation

Once running, access the interactive docs at:

- Swagger UI: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
- ReDoc: [http://127.0.0.1:8000/redoc](http://127.0.0.1:8000/redoc)

---

For more details, see the [Poetry documentation](https://python-poetry.org/docs/) and [FastAPI documentation](https://fastapi.tiangolo.com/).

## Tech Stack Overview

This backend uses the following core libraries:

### Core Libraries

- **FastAPI** — the web framework.
  Handles routing, request/response lifecycle, dependency injection, security, and OpenAPI documentation.

  - **Directory**: `backend/app`

- **Pydantic** — data validation & serialization.
  Defines models for request bodies, responses, and configuration. Ensures type safety and (de)serialization to/from JSON.

  - **Directory**: `backend/app/models`

- **SQLAlchemy** — database ORM & toolkit.
  Provides a high-level interface to define tables/entities, compose queries, and manage sessions/transactions.

  - **Directory**: `backend/app/db`

- **Alembic** — schema migrations for SQLAlchemy.
  Keeps the database schema versioned and synchronized across environments. Supports both autogenerated and manual migrations.
  - **Directory**: `backend/migrations`

### Typical Flow

1. **Client request** → handled by FastAPI endpoint.
2. **Pydantic model** validates and parses the request payload.
3. **SQLAlchemy** session is used to query or update the database.
4. Results are mapped into a **Pydantic response model** and returned.
5. **Alembic migrations** are applied when the database schema evolves.

### Notes

- Keep **Pydantic models** (API schemas) separate from **SQLAlchemy models** (database schemas).
- Manage **SQLAlchemy sessions** per request to avoid leaks.
- Review **Alembic migrations** before applying, even if autogenerated.
